!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("react"));else if("function"==typeof define&&define.amd)define(["react"],t);else{var o="object"==typeof exports?t(require("react")):t(e.react);for(var n in o)("object"==typeof exports?exports:e)[n]=o[n]}}(self,(e=>(()=>{var t={578:e=>{var t;self,t=()=>(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){return null===e?"null":Array.isArray(e)?`[${e.map(o).join(",")}]`:"object"==typeof e?(t=e,`{${Object.keys(t).sort().map((e=>`${e}:${o(t[e])}`)).join(",")}}`):JSON.stringify(e);var t}function n(e,t){return"FILTER"===e.type^"FILTER"===t.type?"FILTER":"DATA"===e.type&&"DATA"===t.type?"DATA":"OTHER"}function i(e,t,i,r){return e.map((e=>{const l=o(e.columnId),s=o(e.rowId);if(!i.has(l))return null;if(!r.has(s))return null;const d=i.get(l),a=r.get(s);return{edit:t.resolve(a,d).edit,cell:e,type:n(d,a)}})).filter((e=>e?.edit))}function r(e,t){return Math.round(e*t)/t}function l(e,t,o){const n=e.state,i=e.canvases[`${t}-${o}`],l=n.sections[t],s=n.sections[o],d=s.columns,a=l.rows;if(0===a.length||0===d.length)return void(i.parentElement&&i.parentElement.removeChild(i));i.parentElement||e.element.appendChild(i);const c=i.getContext("2d",{alpha:!1}),u=n.scrollRect,h=n.textResolver,f=n.renderFormatResolver,m=n.borderWidth,p=l.showTopBorder,g=l.showBottomBorder,y=s.showLeftBorder,w=s.showRightBorder,x=m/2,b=a.length-1+(p?1:0)+(g?1:0),v=d.length-1+(y?1:0)+(w?1:0),k=a.map((e=>e.height)),R=d.map((e=>e.width)),B=R.reduce(((e,t)=>e+t),0)+v*m,E=k.reduce(((e,t)=>e+t),0)+b*m,A="center"===o?u.left:0,C="middle"===t?u.top:0,I="center"===o?u.width:s.width,M="middle"===t?u.height:l.height,T=R.reduce(((e,t,o)=>{const n=e[o]+t+m;return e.push(n),e}),[y?m:0]),L=k.reduce(((e,t,o)=>{const n=e[o]+t+m;return e.push(n),e}),[p?m:0]),F=T.slice(0,-1),N=L.slice(0,-1),S=Math.max(F.findLastIndex((e=>e<=A)),0),K=F.findLastIndex((e=>e<=A+I)),P=Math.max(N.findLastIndex((e=>e<=C)),0),V=N.findLastIndex((e=>e<=C+M)),D=Math.max(S,y?0:1),O=K+(w?1:0),W=Math.max(P,p?0:1),q=V+(g?1:0),Y=Array.from({length:V-P+1},((e,t)=>{const o=a[t+P];return Array.from({length:K-S+1},((e,t)=>{const n=d[t+S];return f.resolve(o,n)}))})),z=(e,t)=>Y[e-P][t-S];i.width=Math.round(I*devicePixelRatio),i.height=Math.round(M*devicePixelRatio),i.style.width=`${I}px`,i.style.height=`${M}px`,i.style.marginLeft=`${A}px`,i.style.marginTop=`${C}px`,i.style.marginRight=B-I-A+"px",i.style.marginBottom=E-M-C+"px",c.fillStyle="#E9E9E9",c.fillRect(0,0,i.width,i.height);const j=(e,t)=>{c.setTransform(devicePixelRatio,0,0,devicePixelRatio,(e-A)*devicePixelRatio,(t-C)*devicePixelRatio)},$=(e,t,o,n)=>{c.beginPath(),c.rect(e,t,o,n),c.clip()};for(let e=S;e<=K;e++){c.save(),j(T[e],0),$(0,0,R[e],E);for(let t=P;t<=V;t++){const o=z(t,e),n=o.style,i=L[t],l=T[e],s=R[e],d=k[t],a="text"in o?o.text:o.value,u=n.textAlign||"left",f=n.textBaseline||"middle",p="paddingLeft"in n?n.paddingLeft:5,g="paddingRight"in n?n.paddingRight:5,y="paddingTop"in n?n.paddingTop:2,w="paddingBottom"in n?n.paddingBottom:2;j(l,i),c.fillStyle=n.background||"white",c.fillRect(0,0,s,d),"draw"in o&&o.draw(c),n.highlight&&(c.fillStyle=n.highlight,c.fillRect(0,0,s,d)),n.corner&&(c.fillStyle=n.corner,c.beginPath(),c.moveTo(s-7,d),c.lineTo(s,d),c.lineTo(s,d-7),c.fill()),c.fillStyle=n.foreground||"black",c.font=n.font||"12px Calibri",c.textAlign=u;const b=h.getFontMetrics(c.font),v=r("left"===u?p:"center"===u?s/2:"right"===u?s-g:0,devicePixelRatio),B=r("top"===f?b.middle+b.topOffset+y:"middle"===f?d/2+b.middle:"bottom"===f?d+b.middle-b.bottomOffset-w:0,devicePixelRatio);B-b.middle-b.topOffset>=0&&B-b.middle+b.bottomOffset<=d?c.fillText(a,v,B):(c.strokeStyle="#E9E9E9",c.lineWidth=m,c.beginPath(),c.moveTo(0,m+x),c.lineTo(s,m+x),c.moveTo(0,d-m-x),c.lineTo(s,d-m-x),c.stroke(),c.save(),$(0,2*m,s,d-4*m),c.fillText(a,v,B),c.restore())}c.restore()}j(0,0);const _=(e,t,o,n,i)=>{if(!i)return;const r=i.width*m,l=t===n,s=e-(l?r/2:0),d=t-(l?0:r/2),a=o+(l?r/2:0),u=n+(l?0:r/2);c.strokeStyle=i.color||"black",c.lineWidth=r,i.dash?(c.setLineDash(i.dash.map((e=>e/devicePixelRatio))),c.lineDashOffset=l?s:d):c.setLineDash([]),c.beginPath(),c.moveTo(s,d),c.lineTo(a,u),c.stroke()},G=(e,t)=>e?t?e.index>t.index?e:t:e:t;for(let e=W;e<=q;e++){const t=e-1,o=e;for(let e=S;e<=K;e++){const n=G(t>=P?z(t,e).style.borderBottom:null,o<=V?z(o,e).style.borderTop:null);_(T[e]-x,L[o]-x,T[e+1]-x,L[o]-x,n)}}for(let e=D;e<=O;e++){const t=e-1,o=e;for(let e=P;e<=V;e++){const n=G(t>=S?z(e,t).style.borderRight:null,o<=K?z(e,o).style.borderLeft:null);_(T[o]-x,L[e]-x,T[o]-x,L[e+1]-x,n)}}}function s(e){l(e,"top","left"),l(e,"top","center"),l(e,"top","right"),l(e,"middle","left"),l(e,"middle","center"),l(e,"middle","right"),l(e,"bottom","left"),l(e,"bottom","center"),l(e,"bottom","right"),function(e){const t=e.element,o=e.input,n=e.state,i=n.inputPlacement;if(i){if(!o.parentElement){const n=document.activeElement===t;e.element.appendChild(o),n&&o.focus()}o.style.left=`${i.left}px`,o.style.top=`${i.top}px`,o.style.width=`${i.width}px`,o.style.height=`${i.height}px`,o.style.backgroundColor=n.isTextValid?"white":"#eb3434"}else if(o.parentElement){const e=document.activeElement===o;o.parentElement.removeChild(o),e&&t.focus()}}(e)}function d(e,t){return[{column:{match:"ANY"},row:{match:"HEADER"},value:({column:e})=>e.header},{column:{match:"ANY"},row:{match:"FILTER"},value:({newValue:e})=>e||"",text:({newValue:e})=>e||"Search...",edit:{validate:()=>!0,parse:({string:e})=>e}},{column:{match:"DATA"},row:{match:"DATA"},value:t},...e]}function a(e){return e}function c(e,t){return t?e+"99":e+"33"}function u(e,t,n,i,r,l){const s=t?o(t.columnId):null,d=t?o(t.rowId):null,a=n?o(n.columnId):null,u=n?o(n.rowId):null,h=(e,t,o,n)=>{if(o<0||o>=e.length)return!1;if(n<0||n>=t.length)return!1;const r=e[o].key,l=t[n].key;return i.isKeySelected(r,l)};return[{column:{match:"ANY"},row:{match:"FILTER"},style:({newValue:e})=>({background:"#FBFBFB",foreground:e?"black":"#cccccc",border:{width:1,color:"gray"}})},{column:{match:"ANY"},row:{match:"HEADER"},style:{background:"#F5F5F5",border:{width:1,color:"gray"}}},...e,{column:{match:"ANY"},row:{match:"ANY"},condition:({row:e,column:t})=>s===t.key||d===e.key,style:{highlight:"#81948133"}},{column:{match:"ANY"},row:{match:"ANY"},condition:({row:e,column:t})=>s===t.key&&d===e.key,style:{highlight:"#81948188"}},{column:{match:"ANY"},row:{match:"ANY"},condition:({rows:e,columns:t,row:o,column:n})=>h(e,t,o.index,n.index),style:({rows:e,columns:t,row:o,column:n,edit:i})=>({...h(e,t,o.index-1,n.index)?{}:{borderTop:{width:3,color:"#596959",index:Number.MAX_SAFE_INTEGER}},...h(e,t,o.index+1,n.index)?{}:{borderBottom:{width:3,color:"#596959",index:Number.MAX_SAFE_INTEGER}},...h(e,t,o.index,n.index-1)?{}:{borderLeft:{width:3,color:"#596959",index:Number.MAX_SAFE_INTEGER}},...h(e,t,o.index,n.index+1)?{}:{borderRight:{width:3,color:"#596959",index:Number.MAX_SAFE_INTEGER}},highlight:c(i?"#798d9c":"#819481",a!==n.key||u!==o.key)})},{column:{match:"ANY"},row:{match:"ANY"},condition:({row:e,column:t})=>r.isKeySelected(e.key,t.key),style:({row:e,column:t})=>({highlight:c("#93a8b8",a!==t.key||u!==e.key)})},{column:{match:"ANY"},row:{match:"ANY"},condition:({row:e,column:t})=>a===t.key&&u===e.key,style:{background:"white"}},{column:{match:"ANY"},row:{match:"ANY"},condition:({edit:e})=>e,style:{corner:"#77777720"}},{column:{match:"ANY"},row:{match:"ANY"},condition:({row:e,column:t})=>l.hasValueByKey(e.key,t.key),style:{corner:"darkgreen"}}]}function h(e,t){const o=t.filter((e=>"BEGIN"===e.pinned)).length,n=t.filter((e=>"END"===e.pinned)).length,i=t.length-o-n,r=e.filter((e=>"BEGIN"===e.pinned)).length,l=e.filter((e=>"END"===e.pinned)).length,s=e.length-r-l,d=t.slice(0,o),a=t.slice(t.length-n,t.length),c=t.slice(o,t.length-n),u=e.slice(0,r),h=e.slice(e.length-l,e.length),f=e.slice(r,e.length-l),m=o>0,p=r>0,g=i>0||!m,y=!m,w=!(n>0),x=s>0||!p,b=!p,v=!(l>0),k=(e,t,o)=>{if(0===e.length)return 0;const n=t?e.at(0).topWithBorder:e.at(0).top;return(o?e.at(-1).bottomWithBorder:e.at(-1).bottom)-n},R=(e,t,o)=>{if(0===e.length)return 0;const n=t?e.at(0).leftWithBorder:e.at(0).left;return(o?e.at(-1).rightWithBorder:e.at(-1).right)-n};return{top:{rows:d,showTopBorder:!0,showBottomBorder:!0,height:k(d,!0,!0)},bottom:{rows:a,showTopBorder:g,showBottomBorder:!0,height:k(a,g,!0)},middle:{rows:c,showTopBorder:y,showBottomBorder:w,height:k(c,y,w)},left:{columns:u,showLeftBorder:!0,showRightBorder:!0,width:R(u,!0,!0)},right:{columns:h,showLeftBorder:x,showRightBorder:!0,width:R(h,x,!0)},center:{columns:f,showLeftBorder:b,showRightBorder:v,width:R(f,b,v)}}}function f(e){return e}function m(e,t){return[...e,...t.map((e=>({columnId:e.columnId,rowId:e.rowId,value:e.expression})))]}e.r(t),e.d(t,{default:()=>ie});class p{constructor(e){this.lookup=new Map,e.forEach((e=>{const t=o(e.rowId),n=o(e.columnId);this.lookup.has(t)||this.lookup.set(t,new Map),this.lookup.get(t).set(n,e.value)}))}hasValueByKey(e,t){return this.lookup.has(e)&&this.lookup.get(e).has(t)}getValueByKey(e,t){if(this.hasValueByKey(e,t))return this.lookup.get(e).get(t)}hasValueById(e,t){return this.hasValueByKey(o(e),o(t))}getValueById(e,t){return this.getValueByKey(o(e),o(t))}}function g(e){return new p(e)}class y{constructor(e){this.lookup=new Map,this.filteredColumns=new Set,this.filteredRows=new Set,e.forEach((e=>{const t=o(e.rowId),n=o(e.columnId);this.lookup.has(t)||this.lookup.set(t,new Map),this.lookup.get(t).set(n,e.expression),this.filteredColumns.add(n),this.filteredRows.add(t)}))}hasRowFilters(){return this.filteredRows.size>0}hasColumnFilters(){return this.filteredColumns.size>0}hasRowFiltersByKey(e){return this.filteredRows.has(e)}hasColumnFiltersByKey(e){return this.filteredColumns.has(e)}hasValueByKey(e,t){return this.lookup.has(e)&&this.lookup.get(e).has(t)}getValueByKey(e,t){if(this.hasValueByKey(e,t))return this.lookup.get(e).get(t)}hasValueById(e,t){return this.hasValueByKey(o(e),o(t))}getValueById(e,t){return this.getValueByKey(o(e),o(t))}hasValueByKeyAndSelector(e,t,o){return"ROW"===o.type?this.hasValueByKey(o.key,t):"COLUMN"===o.type&&this.hasValueByKey(e,o.key)}getValueByKeyAndSelector(e,t,o){return"ROW"===o.type?this.getValueByKey(o.key,t):"COLUMN"===o.type?this.getValueByKey(e,o.key):void 0}}function w(e){return new y(e)}class x{constructor(e){this.lookup=new Map,e.forEach((e=>{const t=o(e.rowId),n=o(e.columnId);this.lookup.has(t)||this.lookup.set(t,new Set),this.lookup.get(t).add(n)}))}isKeySelected(e,t){return this.lookup.has(e)&&this.lookup.get(e).has(t)}isIdSelected(e,t){return this.isKeySelected(o(e),o(t))}}function b(e){return new x(e)}function v(e,t){return"function"==typeof e?e(t):e}function k(e,t,o,n){return e<o?"BEGIN":e>=t-n?"END":void 0}function R(e,t,n){return e.map(((i,r)=>({...i,type:i.type||"DATA",index:r,key:o(i.id),pinned:k(r,e.length,t,n)})))}function B(e,t,o){let n=o;return e.map(((e,i)=>{const l=r(e.width,t),s={...e,index:i,width:l,leftWithBorder:n-o,left:n,right:n+l,rightWithBorder:n+l+o};return n+=s.width+o,s}))}function E(e,t,o){let n=o;return e.map(((e,i)=>{const l=r(e.height,t),s={...e,index:i,height:l,topWithBorder:n-o,top:n,bottom:n+l,bottomWithBorder:n+l+o};return n+=s.height+o,s}))}const A=["borderTop","borderRight","borderBottom","borderLeft"];function C(e,t){const o={...e};if("border"in o){for(const e of A)o[e]=o.border;delete o.border}for(const e of A)e in o&&(o[e]={...o[e],index:t});return o}class I{byKey=new Map;byIndex=new Map;byMatch=new Map}const M={HEADER:["HEADER"],FILTER:["FILTER"],DATA:["DATA"],ANY:["HEADER","DATA","FILTER"],undefined:[]};class T{constructor(e){this.columnLookup=new I,this.rulesCount=0;for(const t of e)this.addRule(t)}addRule(e){const t=this.columnLookup,n=this.rulesCount++,i="column"in e?"id"in e.column?{key:o(e.column.id)}:e.column:{match:"DATA"},r="row"in e?"id"in e.row?{key:o(e.row.id)}:e.row:{match:"DATA"},l={};var s;function d(e,t){e.has(t)||e.set(t,[]),e.get(t).push({index:n,...l})}function a(e,t){e.has(t)||e.set(t,new I),"key"in r&&d(e.get(t).byKey,r.key),"index"in r&&d(e.get(t).byIndex,r.index);for(const o of M[r.match])d(e.get(t).byMatch,o)}"condition"in e&&(l.condition=e.condition),"style"in e&&(l.style="function"==typeof e.style?e.style:()=>e.style),"value"in e&&(l.value="function"==typeof e.value?e.value:()=>e.value),"text"in e&&(l.text="function"==typeof e.text?e.text:()=>e.text),"edit"in e&&(l.edit=e.edit),"draw"in e&&(l.draw=e.draw),"filter"in e&&(l.filter={by:{type:(s=e.filter).by.type,key:o(s.by.id)},condition:s.condition}),"key"in i&&a(t.byKey,i.key),"index"in i&&a(t.byIndex,i.index);for(const e of M[i.match])a(t.byMatch,e)}resolve(e,t,o,n,i,r,l){const s=this.columnLookup,d=[];function a(e){for(const t of e)d.push(t)}function c(e){e.byKey.has(n.key)&&a(e.byKey.get(n.key)),e.byIndex.has(n.index)&&a(e.byIndex.get(n.index)),e.byMatch.has(n.type)&&a(e.byMatch.get(n.type))}s.byKey.has(i.key)&&c(s.byKey.get(i.key)),s.byIndex.has(i.index)&&c(s.byIndex.get(i.index)),s.byMatch.has(i.type)&&c(s.byMatch.get(i.type)),d.sort(((e,t)=>e.index-t.index));let u,h={data:e,rows:t,columns:o,row:n,column:i},f={},m=!0;r.hasValueByKey(n.key,i.key)&&(h={...h,newValue:r.getValueByKey(n.key,i.key)});for(const e of d)if(!("condition"in e)||e.condition(h)){if("value"in e&&(h={...h,value:e.value(h)}),"style"in e&&(f={...f,...C(e.style(h),e.index)}),"text"in e&&(h={...h,text:e.text(h)}),"edit"in e&&(h={...h,edit:e.edit}),"draw"in e){const t=h;u=o=>e.draw({...t,ctx:o})}if("filter"in e&&l.hasValueByKeyAndSelector(n.key,i.key,e.filter.by)){const t={...h,expression:l.getValueByKeyAndSelector(n.key,i.key,e.filter.by)};m=m&&e.filter.condition(t)}}const p={style:f,visible:m};return"value"in h&&(p.value=h.value),"edit"in h&&(p.edit=h.edit),void 0!==u&&(p.draw=u),"text"in h&&(p.text=h.text),p}}function L(e){return new T(e)}class F{constructor(e,t,o,n,i){this.formattingRules=e,this.data=t,this.rows=o,this.columns=n,this.edition=i,this.filtering=new y([])}resolve(e,t){return this.formattingRules.resolve(this.data,this.rows,this.columns,e,t,this.edition,this.filtering)}}function N(e,t,o,n,i){return new F(e,t,o,n,i)}class S{constructor(e,t,o,n,i){this.formattingRules=e,this.data=t,this.rows=o,this.columns=n,this.edition=new p([]),this.filtering=i}findVisibleColumns(){return this.filtering.hasRowFilters()?this.columns.filter((e=>this.rows.every((t=>!this.filtering.hasRowFiltersByKey(t.key)||this.formattingRules.resolve(this.data,this.rows,this.columns,t,e,this.edition,this.filtering).visible)))):this.columns}findVisibleRows(){return this.filtering.hasColumnFilters()?this.rows.filter((e=>this.columns.every((t=>!this.filtering.hasColumnFiltersByKey(t.key)||this.formattingRules.resolve(this.data,this.rows,this.columns,e,t,this.edition,this.filtering).visible)))):this.rows}}function K(e,t,o,n,i){return new S(e,t,o,n,i)}function P(e){return e.findVisibleColumns()}function V(e){return e.findVisibleRows()}function D(e,t,o,n){return{top:e,bottom:t,left:o,right:n}}function O(e,t){return{width:e.length?e.at(-1).rightWithBorder:0,height:t.length?t.at(-1).bottomWithBorder:0}}class W{constructor(){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.fontMetrics=new Map}getFontMetrics(e){const t=e;if(this.fontMetrics.has(t))return this.fontMetrics.get(t);const o=this.context;o.font=e;const n=o.measureText("X"),i=(n.actualBoundingBoxDescent-n.actualBoundingBoxAscent)/2,r={topOffset:i+n.fontBoundingBoxAscent,middle:-i,bottomOffset:n.fontBoundingBoxDescent-i};return this.fontMetrics.set(t,r),r}}function q(){return new W}function Y(e,t){return t.top>=e.top&&t.left>=e.left&&t.top+t.height<=e.top+e.height&&t.left+t.width<=e.left+e.width}function z(e,t){const o={top:Math.max(e.top,t.top),left:Math.max(e.left,t.left),width:Math.min(e.left+e.width,t.left+t.width)-Math.max(e.left,t.left),height:Math.min(e.top+e.height,t.top+t.height)-Math.max(e.top,t.top)};return o.width>=0&&o.height>=0?o:{top:e.top,left:e.left,width:0,height:0}}function j(e,t){return{top:e.top-t,left:e.left-t,width:e.width+2*t,height:e.height+2*t}}function $(e){return e.width*e.height}function _(e,t){return{top:e.top,left:e.left,width:Math.max(0,e.width-t.left-t.right),height:Math.max(0,e.height-t.top-t.bottom)}}const G=200,H=400,X={left:0,top:0,width:0,height:0};function U(e){return e.reduce(((e,t)=>e.set(t.key,t)),new Map)}function J(e,t,n,i,r,l,s){if(!e)return[];if(!n)return[];if(!t)return[];const d=o(t.columnId),a=o(t.rowId),c=o(n.columnId),u=o(n.rowId);if(!l.has(d))return[];if(!s.has(a))return[];if(!l.has(c))return[];if(!s.has(u))return[];const h=Math.min(l.get(d).index,l.get(c).index),f=Math.max(l.get(d).index,l.get(c).index),m=Math.min(s.get(a).index,s.get(u).index),p=Math.max(s.get(a).index,s.get(u).index);return i.slice(h,f+1).flatMap((e=>r.slice(m,p+1).map((t=>({rowId:t.id,columnId:e.id})))))}function Q(e,t,n,i){if(!t)return null;const r=o(t.columnId),l=o(t.rowId);if(!n.has(r))return null;if(!i.has(l))return null;const s=n.get(r),d=i.get(l);return 0===e.length?null:{left:s.left,top:d.top,width:s.width,height:d.height,boxSizing:"border-box"}}function Z(e,t){return t.every((t=>t.edit.validate({string:e})))}function ee(e){console.count("updateState");const t={...e.localOptions,...e.externalOptions},o=e.memory,n=e.state;function r(e,t,n){const i=o[e]&&o[e].dependencies;return i&&!n.some(((e,t)=>e!==i[t]))||(o[e]={value:t(...n),dependencies:n}),o[e].value}const l=window.devicePixelRatio,s=t.borderWidth/l,c=t.data,p=e.input.value,y=r("dataFormatting",d,[t.formatting,t.dataSelector]),x=r("editedCellsAndFilters",m,[t.editedCells,t.filters]),k=r("edition",g,[x]),A=r("filters",w,[t.filters]),C=r("invokedColumns",v,[t.columns,c]),I=r("invokedRows",v,[t.rows,c]),M=r("unfilteredColumns",R,[C,t.pinnedLeft,t.pinnedRight]),T=r("unfilteredRows",R,[I,t.pinnedTop,t.pinnedBottom]),F=r("visibilityFormatting",f,[y]),S=r("visibilityFormattingRules",L,[F]),W=r("visibilityResolver",K,[S,c,T,M,A]),ee=r("filteredColumns",P,[W]),te=r("filteredRows",V,[W]),oe=r("columns",B,[ee,l,s]),ne=r("rows",E,[te,l,s]),ie=r("columnLookup",U,[oe]),re=r("rowLookup",U,[ne]),le=t.focusedCell,se=r("sections",h,[oe,ne]),de=t.selectedCells,ae=r("fixedSize",D,[se.top.height,se.bottom.height,se.left.width,se.right.width]),ce=r("totalSize",O,[oe,ne]),ue=function(e,t,o,n,i,r){if(!t)return null;if(t.x<0||t.y<0||t.x>r.width||t.y>r.height)return null;const l=e.scrollLeft,s=e.scrollTop,d=e.clientWidth,a=e.clientHeight,c=t.x<=i.left?t.x:t.x>=d-i.right?r.width-d+t.x:t.x+l,u=function(e,t){if(0===e.length)return-1;if(t<e[0].topWithBorder)return-1;if(t>e[e.length-1].bottomWithBorder)return-1;let o=0,n=e.length-1;for(;o<=n;){const i=Math.floor((o+n)/2);if(t<e[i].topWithBorder)n=i-1;else{if(!(t>e[i].bottomWithBorder))return i;o=i+1}}return-1}(o,t.y<=i.top?t.y:t.y>=a-i.bottom?r.height-a+t.y:t.y+s),h=function(e,t){if(0===e.length)return-1;if(t<e[0].leftWithBorder)return-1;if(t>e[e.length-1].rightWithBorder)return-1;let o=0,n=e.length-1;for(;o<=n;){const i=Math.floor((o+n)/2);if(t<e[i].leftWithBorder)n=i-1;else{if(!(t>e[i].rightWithBorder))return i;o=i+1}}return-1}(n,c);return-1===u||-1===h?null:{rowId:o[u].id,columnId:n[h].id}}(e.element,e.mousePosition,ne,oe,ae,ce),he=r("highlightedCells",J,[e.isMouseDown,le,ue,oe,ne,ie,re]),fe=r("selection",b,[de]),me=r("highlight",b,[he]),pe=r("renderFormatting",u,[y,ue,le,fe,me,k]),ge=r("renderFormattingRules",L,[pe]),ye=r("renderFormatResolver",N,[ge,c,ne,oe,k]),we=r("inputFormatting",a,[y]),xe=r("inputFormattingRules",L,[we]),be=r("inputFormatResolver",N,[xe,c,ne,oe,k]),ve=r("textResolver",q,[]),ke=r("editableCells",i,[de,be,ie,re]),Re=r("inputPlacement",Q,[ke,le,ie,re]),Be=r("isTextValid",Z,[p,ke]),Ee=function(e,t,o,n){const i={width:n.getBoundingClientRect().width,height:n.getBoundingClientRect().height},r={left:n.scrollLeft,top:n.scrollTop},l=e||X,s=_({left:0,top:0,...t},o),d=_({...r,...i},o),a=z(s,j(d,G)),c=z(s,j(d,H));return Y(s,l)&&Y(l,a)?$(l)>2*$(c)?c:l:c}(n?.scrollRect,ce,ae,e.element);e.state={options:t,devicePixelRatio:l,borderWidth:s,data:c,dataFormatting:y,edition:k,filters:A,unfilteredColumns:M,unfilteredRows:T,visibilityFormatting:F,visibilityResolver:W,filteredColumns:ee,filteredRows:te,columns:oe,rows:ne,sections:se,selectedCells:de,selection:fe,highlight:me,hoveredCell:ue,focusedCell:le,renderFormatting:pe,renderFormatResolver:ye,inputFormatting:we,inputFormatResolver:be,fixedSize:ae,totalSize:ce,textResolver:ve,scrollRect:Ee,highlightedCells:he,inputPlacement:Re,columnLookup:ie,rowLookup:re,text:p,isTextValid:Be}}function te(e,t){const o=new x(t);return[...t,...e.filter((e=>!o.isIdSelected(e.rowId,e.columnId)))]}function oe(e,t){const o=new x(t);return e.filter((e=>!o.isIdSelected(e.rowId,e.columnId)))}function ne(e){if("spread-grid-context"in e)return;const t={"top-left":document.createElement("canvas"),"top-center":document.createElement("canvas"),"top-right":document.createElement("canvas"),"middle-left":document.createElement("canvas"),"middle-center":document.createElement("canvas"),"middle-right":document.createElement("canvas"),"bottom-left":document.createElement("canvas"),"bottom-center":document.createElement("canvas"),"bottom-right":document.createElement("canvas")},n=document.createElement("input");e.setAttribute("tabindex","0"),e.setAttribute("style","max-width: 100vw; max-height: 100vh; overflow: auto; display: grid; position: relative; grid-template-columns: fit-content(0) fit-content(0) fit-content(0); grid-template-rows: fit-content(0) fit-content(0) fit-content(0); outline: none;"),e.classList.add("spread-grid"),t["top-left"].setAttribute("style","position: sticky; left: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 1;"),t["top-center"].setAttribute("style","position: sticky; top: 0; z-index: 1; grid-row: 1; grid-column: 2;"),t["top-right"].setAttribute("style","position: sticky; right: 0; top: 0; z-index: 2; grid-row: 1; grid-column: 3;"),t["middle-left"].setAttribute("style","position: sticky; left: 0; z-index: 1; grid-row: 2; grid-column: 1;"),t["middle-center"].setAttribute("style","grid-row: 2; grid-column: 2;"),t["middle-right"].setAttribute("style","position: sticky; right: 0; z-index: 1; grid-row: 2; grid-column: 3;"),t["bottom-left"].setAttribute("style","position: sticky; left: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 1;"),t["bottom-center"].setAttribute("style","position: sticky; bottom: 0; z-index: 1; grid-row: 3; grid-column: 2;"),t["bottom-right"].setAttribute("style","position: sticky; right: 0; bottom: 0; z-index: 2; grid-row: 3; grid-column: 3;"),n.setAttribute("style","position: absolute; z-index: 3; outline: none; border: none; box-shadow: none; padding: 0 5px; font-size: 12px; font-family: Calibri; background-color: white; box-sizing: border-box; opacity: 0; pointer-events: none;");const r={externalOptions:{},state:null,memory:{},element:e,canvases:t,input:n,renderRequested:!1,mousePosition:null,isMouseDown:!1,requestNewRender:()=>{r.renderRequested||(r.renderRequested=!0,requestAnimationFrame((()=>{r.renderRequested=!1,ee(r),s(r)})))}};r.localOptions={data:[],columns:e=>e.length>0?Object.keys(e[0]).map((e=>({id:e,header:e,width:100}))):[],rows:e=>[{id:"top-header",type:"HEADER",height:20},...e.map(((e,t)=>({id:t,height:20})))],formatting:[],dataSelector:({data:e,row:t,column:o})=>e[t.id][o.id],pinnedTop:0,pinnedBottom:0,pinnedLeft:0,pinnedRight:0,borderWidth:1,focusedCell:null,onFocusedCellChange:e=>{r.localOptions.focusedCell=e,r.requestNewRender()},selectedCells:[],onSelectedCellsChange:e=>{r.localOptions.selectedCells=e,r.requestNewRender()},highlightedCells:[],editedCells:[],onEditedCellsChange:e=>{r.localOptions.editedCells=e,r.requestNewRender()},filters:[],onFiltersChange:e=>{r.localOptions.filters=e,r.requestNewRender()}},e["spread-grid-context"]=r;const l=e=>{n.value=e,n.dispatchEvent(new Event("input"))};e.addEventListener("scroll",(e=>{r.requestNewRender()})),e.addEventListener("mouseenter",(t=>{r.mousePosition={x:t.clientX-e.offsetLeft,y:t.clientY-e.offsetTop},r.requestNewRender()})),e.addEventListener("mousemove",(t=>{r.mousePosition={x:t.clientX-e.offsetLeft,y:t.clientY-e.offsetTop},r.requestNewRender()})),e.addEventListener("mouseleave",(()=>{r.mousePosition=null,r.requestNewRender()})),e.addEventListener("mousedown",(e=>{ee(r),l(""),r.isMouseDown=!0,r.state.options.onFocusedCellChange(r.state.hoveredCell),e.ctrlKey||r.state.options.onSelectedCellsChange([]),r.requestNewRender()})),e.addEventListener("mouseup",(e=>{ee(r),r.isMouseDown=!1,r.state.options.onSelectedCellsChange(te(r.state.options.selectedCells,r.state.highlightedCells)),r.requestNewRender()})),e.addEventListener("dblclick",(e=>{ee(r);const t=r.state.focusedCell;if(null===t)return;const i=o(t.columnId),s=o(t.rowId),d=r.state.columnLookup,a=r.state.rowLookup,c=r.state.inputFormatResolver;if(!d.has(i))return;if(!a.has(s))return;const u=d.get(i),h=a.get(s),f=`${c.resolve(h,u).value}`;l(f),n?.select()})),e.addEventListener("focus",(()=>{n.parentElement&&n.focus()})),e.addEventListener("keydown",(e=>{ee(r);const t=r.state.focusedCell,n=r.state.columnLookup,s=r.state.rowLookup,d=r.state.inputFormatResolver,a=r.state.options.selectedCells,c=r.state.options.onSelectedCellsChange,u=r.state.options.onFocusedCellChange,h=r.state.options.editedCells,f=r.state.options.onEditedCellsChange,m=r.state.options.onFiltersChange,p=r.state.columns,g=r.state.rows,y=r.state.text,w=r.state.isTextValid,x=(e,t)=>{u(e),t.shiftKey?c(te(a,[e])):c([e])},b=(e,i)=>{if(!t)return;const r=o(t.columnId);if(!n.has(r))return;const l=n.get(r).index,s=Math.max(0,Math.min(p.length-1,l+e));if(s===l)return;const d={rowId:t.rowId,columnId:p[s].id};x(d,i)},v=(e,n)=>{if(!t)return;const i=o(t.rowId);if(!s.has(i))return;const r=s.get(i).index,l=Math.max(0,Math.min(g.length-1,r+e));if(l===r)return;const d={rowId:g[l].id,columnId:t.columnId};x(d,n)},k=()=>{e.preventDefault(),e.stopPropagation()};switch(e.key){case"Escape":""!==y?l(""):a.length>1?c([t]):h.length>0?f([]):(u(null),c([]));break;case"Enter":(()=>{const e=i(a,d,n,s);if(""===y)return;if(!w)return;const t=e.filter((e=>"DATA"===e.type)),o=e.filter((e=>"FILTER"===e.type));var c;c=t.map((e=>({...e.cell,value:e.edit.parse({string:y})}))),f(te(r.state.options.editedCells,c)),(e=>{m(te(r.state.options.filters,e))})(o.map((e=>({...e.cell,expression:e.edit.parse({string:y})})))),l("")})();break;case"ArrowUp":k(),v(e.ctrlKey?-g.length:-1,e);break;case"ArrowDown":k(),v(e.ctrlKey?g.length:1,e);break;case"ArrowLeft":k(),b(e.ctrlKey?-p.length:-1,e);break;case"ArrowRight":k(),b(e.ctrlKey?p.length:1,e);break;case"Delete":case"Backspace":R=a,f(oe(r.state.options.editedCells,R)),(e=>{m(oe(r.state.options.filters,e))})(a)}var R})),new ResizeObserver((()=>{r.requestNewRender()})).observe(e),n.addEventListener("input",(e=>{e.target.value?(n.style.opacity=1,n.style.pointerEvents="auto"):(n.style.opacity=0,n.style.pointerEvents="none")})),n.addEventListener("click",(e=>{e.stopPropagation()})),n.addEventListener("dblclick",(e=>{e.stopPropagation()})),n.addEventListener("mousedown",(e=>{e.stopPropagation()})),n.addEventListener("keydown",(e=>{switch(e.key){case"Enter":case"Escape":break;case"Delete":case"Backspace":case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":""!==n.value&&(e.stopPropagation(),r.requestNewRender());break;default:e.stopPropagation(),r.requestNewRender()}}))}function ie(e,t){console.log("createGrid"),ne(e);const o=e["spread-grid-context"];o.externalOptions=t,null===o.state?(ee(o),s(o)):o.requestNewRender()}return t})(),e.exports=t()},155:t=>{"use strict";t.exports=e}},o={};function n(e){var i=o[e];if(void 0!==i)return i.exports;var r=o[e]={exports:{}};return t[e](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{"use strict";n.r(i),n.d(i,{default:()=>l});var e=n(155),t=n.n(e),o=n(578),r=n.n(o);function l(o){const[n,i]=(0,e.useState)(null);return n&&r()(n,o),t().createElement("div",{ref:i})}})(),i})()));